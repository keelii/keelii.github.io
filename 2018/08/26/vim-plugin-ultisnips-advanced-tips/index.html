<!DOCTYPE html>   
<html class="no-js" lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>VIM ä»£ç ç‰‡æ®µæ’ä»¶ Ultisnips ä½¿ç”¨æ•™ç¨‹</title>
    <meta name="description" content="__ you don&#39;t know yet">
    <meta name="keywords" content="">
    <meta name="author" content="keelii">
    <meta name="generator" content="Hugo 0.54.0" />

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    

    <link rel="canonical" href="https://keelii.com/2018/08/26/vim-plugin-ultisnips-advanced-tips/">
    <link href="https://keelii.com/favicon.ico" rel="icon">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="##f7f7f7">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="##f7f7f7">

    <link href="https://keelii.com/atom.xml" rel="alternate" type="application/rss+xml" title="è‡¨æ± ä¸è¼Ÿ">

    
    <link href="/stylesheets/main.min.css" rel="stylesheet" type="text/css">

    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-79264835-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-79264835-1');
    </script>

</head>
<body>

<script>
    (function(window, document) {
        window.changeTheme = function() {
            var el = document.getElementById('dark-theme')
            var dark = localStorage.getItem('dark')
            if (dark === 'true') {
                document.body.classList.add('dark')
                if (el) el.checked = true
            } else {
                document.body.classList.remove('dark')
                if (el) el.checked = false
            }
        }
        changeTheme()
    })(window, document);
</script>

<div id="main" class="container">
    <div id="content" class="typo">
        <div style="padding-top:0;">
            <article class="hentry" role="article">
                <header>
                    <h1 class="entry-title">VIM ä»£ç ç‰‡æ®µæ’ä»¶ ultisnips ä½¿ç”¨æ•™ç¨‹</h1>
                    <p class="meta">
                        <time class="entry-date" datetime="2018-08-26 17:59:45">
                            <span class="date">2018-8-26</span>
                            <span class="time">17:59 PM</span>
                            Â· <a href="https://keelii.com/">é¦–é¡µ</a>
                        </time>
                    </p>
                </header>

                <div class="entry-content">

<h2 id="å®‰è£…">å®‰è£…</h2>

<p><a href="https://github.com/SirVer/ultisnips">Ultisnips</a> æ’ä»¶å®‰è£…åˆ†ä¸¤éƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯ ultisnips æ’ä»¶æœ¬èº«ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ä»£ç ç‰‡æ®µä»“åº“ã€‚ä¸€èˆ¬æ¥è¯´æŠŠé»˜è®¤çš„ä»£ç ç‰‡æ®µä»“åº“ä¸‹è½½ä¸‹æ¥æŒ‰éœ€ä¿®æ”¹åä¸Šä¼ åˆ°è‡ªå·±çš„ github å³å¯ã€‚å¦‚æœä½ å’Œæˆ‘ä¸€æ ·ä¹Ÿä½¿ç”¨ vim-plug æ¥ç®¡ç†æ’ä»¶çš„è¯ï¼Œæ·»åŠ ä¸‹é¢çš„ä»£ç åˆ°ä½ çš„ vimrc ä¸­ä¿å­˜åˆ·æ–°å³å¯</p>

<pre><code class="language-vim">Plug 'SirVer/ultisnips'
# ä½ è‡ªå·±çš„ä»£ç ä»“åº“ git åœ°å€
Plug 'keelii/vim-snippets'
</code></pre>

<p>ä¸Šé¢çš„ç¤ºä¾‹ä¸­æ‰€æœ‰çš„ä»£ç ç‰‡æ®µéƒ½å­˜æ”¾åœ¨æ’ä»¶å®‰è£…ç›®å½•ä¸‹é¢çš„ <code>vim-snippets/UltiSnips</code> ä¸­ï¼Œæ–‡ä»¶å‘½åæ ¼å¼ä¸º <code>ft</code>.snippets, <code>ft</code> å°±æ˜¯ vim ä¸­çš„ <code>filetype</code>ï¼Œå…¶ä¸­æœ‰ä¸ª <code>all.snippets</code> æ˜¯å”¯ä¸€ä¸€ä¸ªæ‰€æœ‰æ–‡ä»¶éƒ½é€‚ç”¨çš„ä»£ç ç‰‡æ®µ</p>

<h2 id="é…ç½®">é…ç½®</h2>

<p>å¿«æ·é”®è®¾ç½®ï¼Œæˆ‘ä¸€èˆ¬ä½¿ç”¨ tab æ¥è§¦å‘ä»£ç ç‰‡æ®µè¡¥å…¨ï¼Œ<strong>ä¸”ä¸ä½¿ç”¨ YCM</strong> ï¼ˆå®˜æ–¹æ–‡æ¡£è¡¨ç¤ºä½¿ç”¨YCMçš„è¯å°±ä¸èƒ½ä½¿ç”¨tabè¡¥å…¨ï¼‰</p>

<pre><code class="language-vim">let g:UltiSnipsExpandTrigger=&quot;&lt;tab&gt;&quot;
&quot; ä½¿ç”¨ tab åˆ‡æ¢ä¸‹ä¸€ä¸ªè§¦å‘ç‚¹ï¼Œshit+tab ä¸Šä¸€ä¸ªè§¦å‘ç‚¹
let g:UltiSnipsJumpForwardTrigger=&quot;&lt;tab&gt;&quot;
let g:UltiSnipsJumpBackwardTrigger=&quot;&lt;S-tab&gt;&quot;
&quot; ä½¿ç”¨ UltiSnipsEdit å‘½ä»¤æ—¶å‚ç›´åˆ†å‰²å±å¹•
let g:UltiSnipsEditSplit=&quot;vertical&quot;
</code></pre>

<h2 id="ä¾èµ–">ä¾èµ–</h2>

<p>ultisnips æ’ä»¶éœ€è¦ä½ çš„ vim æ”¯æŒ pythonï¼Œå¯ä»¥åœ¨ vim å‘½ä»¤æ¨¡å¼ä¸‹ä½¿ç”¨ä¸‹é¢çš„æ£€æµ‹ä½ çš„ vim ç‰ˆæœ¬æ˜¯å¦æ”¯æŒ python</p>

<pre><code># 1 è¡¨ç¤ºæ”¯æŒ
:echo has(&quot;python&quot;)
:echo has(&quot;python3&quot;)
</code></pre>

<h2 id="å®šä¹‰ä¸€ä¸ªä»£ç ç‰‡æ®µ">å®šä¹‰ä¸€ä¸ªä»£ç ç‰‡æ®µ</h2>

<h3 id="å®šä¹‰æ ¼å¼">å®šä¹‰æ ¼å¼</h3>

<pre><code class="language-vim">snippet è§¦å‘å­—ç¬¦ [&quot;ä»£ç ç‰‡æ®µè¯´æ˜&quot; [å‚æ•°]]
ä»£ç ç‰‡æ®µå†…å®¹
endsnippet
</code></pre>

<h3 id="æœ€å°åŒ–çš„ä¸€ä¸ªä»£ç ç‰‡æ®µ">æœ€å°åŒ–çš„ä¸€ä¸ªä»£ç ç‰‡æ®µ</h3>

<pre><code>snippet if &quot;if (condition) { ... }&quot;
if (${1:true}) {
    $0
}
endsnippet
</code></pre>

<p>è¿™æ—¶å½“ä½ åœ¨ vim ä¸­è¾“å…¥ if æ•² tab å°±ä¼šå±•å¼€ä¸€æ¡ if è¯­å¥ï¼Œç¬¬ä¸€ä¸ªè§¦å‘ç‚¹æ˜¯ if æ¡ä»¶è¡¨è¾¾å¼ï¼Œæœ€åä¸€ä¸ªæ˜¯ if è¯­å¥ä½“</p>

<p><code>${1:true}</code> è¡¨ç¤ºè¿™æ˜¯ç¬¬ä¸€ä¸ªè§¦å‘ç‚¹ï¼Œå ä½ç¬¦ä¸º <code>true</code>ï¼Œå¦‚æœå ä½ç¬¦æ²¡æœ‰é»˜è®¤å€¼å¯ç›´æ¥ä½¿ç”¨ <code>$1</code>, <code>$2</code>, <code>$3</code>&hellip;</p>

<h2 id="å¯è§†é€‰æ‹©åŒºçš„å†…å®¹ä¸ºå ä½ç¬¦">å¯è§†é€‰æ‹©åŒºçš„å†…å®¹ä¸ºå ä½ç¬¦</h2>

<pre><code>snippet if &quot;if (...)&quot;
if (${1:true}) {
    ${VISUAL}
}
endsnippet
</code></pre>

<p><code>${VISUAL}</code> è¡¨ç¤ºåœ¨ vim ä¸­ä½¿ç”¨å¯è§†æ¨¡å¼ä¸‹é€‰æ‹©çš„æ–‡æœ¬ï¼Œè¿™ä¸ªåœ¨é‡æ„ä»£ç çš„æ—¶å€™<strong>éå¸¸æœ‰ç”¨</strong>ï¼ˆåé¢ä¼šæœ‰é«˜çº§ç”¨æ³•ï¼‰ï¼Œä¸Šä¸ªå›¾æ„Ÿå—ä¸€ä¸‹</p>

<p><img src="//img10.360buyimg.com/devfe/jfs/t25252/299/1019207883/36468/bca93de/5b84a8a9N8dd5a8c5.gif" alt="if-with-visual-mode" /></p>

<h2 id="ä»£ç ç‰‡æ®µçš„å‚æ•°">ä»£ç ç‰‡æ®µçš„å‚æ•°</h2>

<ul>
<li><code>b</code> è¡¨ç¤ºè§¦å‘å­—ç¬¦åº”è¯¥åœ¨ä¸€è¡Œçš„å¼€å§‹</li>
<li><code>i</code> è¡¨ç¤ºè§¦å‘å­—ç¬¦å¯ä»¥åœ¨å•è¯å†…ï¼ˆè¿ç»­å±•ç¤ºä¼šä½¿ç”¨è¿™ä¸ªé€‰é¡¹ï¼‰</li>
<li><code>w</code> è¡¨ç¤ºè§¦å‘å­—ç¬¦çš„å‰åå¿…é¡»æ˜¯ä¸€ä¸ªå­—æ¯åˆ†ç•Œç‚¹</li>
<li><code>r</code> è¡¨ç¤ºè§¦å‘å­—ç¬¦å¯ä»¥æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼</li>
<li><code>t</code> è¡¨ç¤ºå±•å¼€çš„ä»£ç ç‰‡æ®µä¸­å¦‚æœæœ‰åˆ¶è¡¨ç¬¦ï¼ŒåŸæ ·è¾“å‡ºï¼Œå³ä½¿ä½ çš„ vimrc é‡Œé¢è®¾ç½®äº† expandtab</li>
<li><code>m</code> è¡¨ç¤ºåˆ é™¤ä»£ç ç‰‡æ®µå³è¾¹çš„æ‰€æœ‰ç©ºç™½å­—ç¬¦</li>
<li><code>e</code> è¡¨ç¤ºè‡ªå®šä¹‰ä¸Šä¸‹æ–‡</li>
<li><code>A</code> è¡¨ç¤ºè‡ªåŠ¨è§¦å‘ï¼Œä¸éœ€è¦æŒ‰ tabï¼Œç±»ä¼¼äº VIM ä¸­çš„ abbr</li>
</ul>

<h2 id="å†…å®¹è§£é‡Šå™¨">å†…å®¹è§£é‡Šå™¨</h2>

<p>Ultisnips å®šä¹‰çš„ä»£ç ç‰‡æ®µä¸­æ”¯æŒä¸‰ç§ä¸åŒçš„è¯­è¨€æ³¨å…¥ï¼šshell, vimscript, pythonï¼Œåœ¨ä»£ç ç‰‡æ®µä¸­ç”¨åå¼•å·è¡¨ç¤º</p>

<h2 id="shell-ä»£ç ">shell ä»£ç </h2>

<p>å°±æ˜¯åœ¨ä½ çš„å‘½ä»¤è¡Œ shell èƒ½æ‰§è¡Œçš„ä»£ç ç‰‡æ®µï¼Œæ¯”å¦‚è¾“å‡ºå½“å‰æ—¶é—´</p>

<pre><code class="language-bash">âœ date
2018å¹´ 8æœˆ27æ—¥ æ˜ŸæœŸä¸€ 18æ—¶19åˆ†38ç§’ CST
</code></pre>

<p>åœ¨ä»£ç ç‰‡æ®µä¸­ç”¨åå¼•å·ã€Œ`ã€å¼•ç”¨å³å¯</p>

<pre><code class="language-vim">snippet today
Today is the `date`.
endsnippet
</code></pre>

<p>è¾“å…¥ today æŒ‰ tab å±•å¼€åï¼ˆæ ¼å¼å’Œä¸Šé¢shellä¸­çš„ä¸ä¸€æ ·ï¼Œä¼°è®¡æ˜¯å› ä¸º vim è¯­è¨€è®¾ç½®çš„é—®é¢˜ï¼‰ï¼š</p>

<pre><code>Today is the Mon Aug 27 18:24:51 CST 2018.
</code></pre>

<h3 id="vimscript-ä»£ç ">vimscript ä»£ç </h3>

<p>ä½¿ç”¨ <code>indent</code> æ¥è¾“å‡ºå½“å‰ç¼©è¿›å€¼ï¼Œä½¿ç”¨å‰ç¼€ <code>!v</code> è¡¨ç¤ºæ˜¯ vimscript</p>

<pre><code class="language-vim">snippet indent
Indent is: `!v indent(&quot;.&quot;)`.
endsnippet
</code></pre>

<p><img src="//img12.360buyimg.com/devfe/jfs/t23467/4/2565317844/22166/a39566b/5b84a97fNa6174311.gif" alt="vimscript-indent-size" /></p>

<h3 id="python-ä»£ç ">python ä»£ç </h3>

<p>åœ¨ä»£ç ç‰‡æ®µä¸­è§£é‡Šæ‰§è¡Œ python ä»£ç æ˜¯ ultisnips æœ€å¼ºå¤§çš„åŠŸèƒ½ï¼Œä»¥å‰ç¼€ <code>!p</code> å¼€å§‹ã€‚ç³»ç»Ÿä¼šå‘ python ä¸­æ³¨å…¥ä¸€äº›å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨ python ä»£ç ç›´æ¥å¯¹å…¶è¿›è¡Œæ“ä½œ</p>

<ul>
<li><code>fn</code> - è¡¨ç¤ºå½“å‰æ–‡ä»¶å</li>
<li><code>path</code> -  å½“å‰æ–‡ä»¶åçš„è·¯å¾„</li>
<li><code>t</code> - å ä½ç¬¦çš„å­—å…¸ï¼Œå¯ä»¥ä½¿ç”¨ <code>t[1], t[2], t.v</code> æ¥å–å ä½ç¬¦å†…å®¹</li>
<li><code>snip</code> - <a href="https://github.com/SirVer/ultisnips/blob/6fdc3647f72e0a1f321ea6bd092ecd01f7c187ba/pythonx/UltiSnips/text_objects/_python_code.py#L56">UltiSnips.TextObjects.SnippetUtil</a> å¯¹è±¡çš„ä¸€ä¸ªå®ä¾‹</li>
<li><code>match</code> - æ­£åˆ™ä»£ç ç‰‡æ®µæ—¶è¿”å›çš„åŒ¹é…å…ƒç´ ï¼ˆéå¸¸å¼ºå¤§ï¼‰</li>
</ul>

<p>å…¶ä¸­æœ€å¸¸ç”¨çš„ <code>snip</code> å¯¹è±¡æä¾›äº†ä¸‹é¢ä¸€äº›å˜é‡ï¼š</p>

<ul>
<li><code>snip.rv</code> è¡¨ç¤º return valueï¼Œpython ä»£ç æ‰§è¡Œåå¤„ç†è¿‡çš„å­—ç¬¦ä¸²èµ‹ç»™ rv å³å¯</li>
<li><code>snip.fn</code> è¡¨ç¤ºå½“å‰æ–‡ä»¶å</li>
<li><code>snip.ft</code> è¡¨ç¤ºå½“å‰æ–‡ä»¶ç±»å‹</li>
<li><code>snip.v</code> è¡¨ç¤º VISUAL æ¨¡å¼å˜é‡ï¼Œå…¶ä¸­ <code>snip.v.mode</code> è¡¨ç¤ºæ¨¡å¼ç±»å‹ï¼Œ<code>snip.v.text</code> è¡¨ç¤º VISUAL æ¨¡å¼ä¸­é€‰æ‹©çš„å­—ç¬¦</li>
</ul>

<p><img src="//img11.360buyimg.com/devfe/jfs/t27739/311/103185395/173892/d6a786e3/5b84af90Nfa6cd193.gif" alt="python-snippet-var" /></p>

<h2 id="å ä½ç¬¦é€‰æ‹©">å ä½ç¬¦é€‰æ‹©</h2>

<p>UltiSnips æ”¯æŒä½¿ç”¨å¿«æ·é”®åˆ‡æ¢å ä½ç¬¦ï¼Œæˆ‘ä½¿ç”¨ <code>&lt;tab&gt;</code> å’Œ <code>&lt;shift-tab&gt;</code> æ¥åˆ‡æ¢ <code>ä¸‹ä¸€ä¸ª</code> å’Œ <code>ä¸Šä¸€ä¸ª</code> å ä½ç¬¦ï¼Œå ä½ç¬¦åˆ‡æ¢çš„ä½œç”¨åŸŸä¸ºå½“å‰ä»£ç ç‰‡æ®µå†…éƒ¨ï¼ˆå³ä½¿å ä½ç¬¦å·²è¢«ä¿®æ”¹è¿‡ï¼‰ï¼Œå½“å…‰æ ‡ç§»åŠ¨å‡ºå»ä»¥åå°±ä¸èµ·ä½œç”¨äº†</p>

<p><img src="//img12.360buyimg.com/devfe/jfs/t24559/158/2571218888/171431/2459a91d/5b84bf9aN96a7ee7e.gif" alt="mul-placeholder-editing" /></p>

<h2 id="è‡ªå®šä¹‰ä¸Šä¸‹æ–‡">è‡ªå®šä¹‰ä¸Šä¸‹æ–‡</h2>

<p>è‡ªå®šä¹‰ä¸Šä¸‹æ–‡å¯ä»¥é€šè¿‡æ­£åˆ™åŒ¹é…æ¥å†³å®šä»£ç ç‰‡æ–­æ˜¯å¦å¯ç”¨ï¼Œæ¯”å¦‚åˆ¤æ–­åœ¨æŒ‡å®šçš„ if è¯­å¥é‡Œé¢æ‰èµ·ä½œç”¨çš„ä»£ç ç‰‡æ–­ï¼Œå®šä¹‰æ ¼å¼å¦‚ä¸‹ï¼š</p>

<blockquote>
<p>snippet è§¦å‘å­—ç¬¦ &ldquo;æè¿°&rdquo; &ldquo;è¡¨è¾¾å¼&rdquo; å‚æ•°</p>
</blockquote>

<p>æ¯”å¦‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª <strong>åªæœ‰</strong> åœ¨ä¸Šä¸€è¡Œä»¥ <code>if (DEVELOPMENT) {</code> å¼€å¤´æ‰å¯ä»¥å±•å¼€çš„ä»£ç ç‰‡æ®µ</p>

<pre><code>snippet dbg &quot;if (DEVELOPMENT) dbg&quot; &quot;re.match('^if \(DEVELOPMENT\) \{', snip.buffer[snip.line-1])&quot; be
debugger;
endsnippet
</code></pre>

<h2 id="å¸¸è§ç”¨æ³•">å¸¸è§ç”¨æ³•</h2>

<h3 id="è¡Œå†…è¿ç»­å±•å¼€">è¡Œå†…è¿ç»­å±•å¼€</h3>

<p>è¿™ä¸ªå¸¸è§äºéœ€è¦è¿ç»­å±•å¼€ä»£ç ç‰‡æ®µçš„æƒ…å†µï¼Œæ¯”å¦‚ï¼Œæœ‰ä¸¤ä¸ªç‰‡æ®µï¼Œä¸€ä¸ªæ‰“å°å˜é‡ï¼Œä¸€ä¸ªå¤„ç† JSON åºåˆ—åŒ–ã€‚è¿™æ—¶éœ€è¦ä½¿ç”¨å‚æ•°é€‰é¡¹ <code>i</code>n-word</p>

<p><img src="//img11.360buyimg.com/devfe/jfs/t25579/50/1036526670/419976/53521e3b/5b84c7d2Nd6a0cb5e.gif" alt="continue-expand-snippets" /></p>

<h3 id="ä½¿ç”¨æ­£åˆ™ä»£ç ç‰‡æ®µ">ä½¿ç”¨æ­£åˆ™ä»£ç ç‰‡æ®µ</h3>

<p>é€šå¸¸å†™ä»£ç çš„æ—¶å€™éœ€è¦ä½¿ç”¨ log, print ç­‰æ¥æ‰“å°ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ã€‚ä½¿ç”¨æ™®é€šç‰‡æ®µæŒ‰ cl å±•ç¤º console.log() ç„¶åæŠŠå˜é‡å­—ç¬¦å¤åˆ¶è¿›æ‹¬å·ï¼Œè¿™æ ·æ“ä½œä¼šæ¯”è¾ƒå¤æ‚ã€‚ä½¿ç”¨æ­£åˆ™æ¥åŠ¨æ€åŒ¹é…å‰é¢çš„å­—ç¬¦å¯ä»¥å¾ˆå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜</p>

<pre><code class="language-vim"># å±•å¼€ console.log
snippet &quot;([^\s]\w+)\.log&quot; &quot;console.log(postfix)&quot; r
console.log(`!p snip.rv = match.group(1)`)$0
endsnippet
# å½“å‰è¡Œè½¬æ¢æˆå¤§å†™
snippet &quot;([^\s].*)\.upper&quot; &quot;Uppercase(postfix)&quot; r
`!p snip.rv = match.group(1).upper()`$0
endsnippet
# ä¸Šä¸€ä¸ªå•è¯è½¬æ¢æˆå°å†™
snippet &quot;([^\s]\w+)\.lower&quot; &quot;Lowercase(postfix)&quot; r
`!p snip.rv = match.group(1).lower()`$0
endsnippet
</code></pre>

<p>åŠ¨å›¾æ¼”ç¤º</p>

<p><img src="//img30.360buyimg.com/devfe/jfs/t25492/223/971280921/61984/701b0ab1/5b84cc6aN6fe8ea04.gif" alt="expand-regexp-snippets" /></p>

<p><strong>æ³¨æ„</strong>ï¼šæ­£åˆ™ä»£ç ç‰‡æ®µåªé€‚ç”¨äºå•è¡Œæ–‡æœ¬å¤„ç†ï¼Œå¦‚æœæ˜¯å¤šè¡Œè½¬æ¢è¿˜æ˜¯å¾—ç”¨åˆ°ä¸‹é¢çš„ python + VISUAL ä»£ç ç‰‡æ®µæ¥å¤„ç†</p>

<h3 id="ä½¿ç”¨-python-è§£é‡Šå™¨-visual-æ¨¡å¼å®ç°ä»£ç æ³¨é‡ŠåŠŸèƒ½">ä½¿ç”¨ python è§£é‡Šå™¨ + VISUAL æ¨¡å¼å®ç°ä»£ç æ³¨é‡ŠåŠŸèƒ½</h3>

<p>é€šå¸¸æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€å¤§å †æ’ä»¶æ¥å®ç°å„ç§ä»£ç çš„æ³¨é‡ŠåŠŸèƒ½ã€‚ä¸è¿‡ Ultisnips æä¾›äº† VISUAL æ¨¡å¼å¯ä»¥æå– vim å¯è§†æ¨¡å¼ä¸­é€‰æ‹©çš„å†…å®¹åˆ°ä»£ç ç‰‡æ®µé‡Œé¢ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥ç»“åˆèµ·æ¥åˆ¶ä½œä¸€ä¸ª<strong>å…·æœ‰æ³¨é‡ŠåŠŸèƒ½çš„ä»£ç ç‰‡æ®µ</strong></p>

<p>æµç¨‹å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>

<ol>
<li>è¿›å…¥ vim å¯è§†æ¨¡å¼ï¼Œé€‰æ‹©è¦æ³¨é‡Šçš„å†…å®¹</li>
<li>æŒ‰ tabï¼Œæ¸…é™¤é€‰æ‹©å†…å®¹</li>
<li>è¾“å…¥ä»£ç ç‰‡æ®µè§¦å‘å­—ç¬¦ï¼ŒæŒ‰ tab å®Œæˆ</li>
</ol>

<p>ç”±äºå®ç°çš„ python ä»£ç ç›¸å¯¹å¤æ‚ä¸€äº›ï¼Œä¸»è¦åˆ†æˆä¸¤ä¸ªæ–¹æ³•ã€‚å•è¡Œæ³¨é‡Šå’Œå¤šè¡Œæ³¨é‡Šï¼Œæ³¨æ„ Ultisnips ä¸­å¯ä»¥ç›´æ¥å†™ python ä½†æ˜¯å¤§æ®µçš„æ–¹æ³•å»ºè®®æ”¾åœ¨æ’ä»¶ç›®å½•ä¸‹é¢çš„ pythonx ç›®å½•ä¸‹é¢ï¼Œä½¿ç”¨çš„æ—¶å€™åœ¨å¯¹åº”çš„ä»£ç ç‰‡æ®µä¸­çš„å…¨å±€ python ä»£ç  <code>global !p</code> å¼•å…¥å³å¯</p>

<p><strong>å•è¡Œæ³¨é‡Š</strong>(pythonx/javascript_snippets.py)ï¼š</p>

<pre><code class="language-python">def comment(snip, START=&quot;&quot;, END=&quot;&quot;):
    lines = snip.v.text.split('\n')[:-1]
    first_line = lines[0]
    spaces = ''
    initial_indent = snip._initial_indent

    # Get the first non-empty line
    for idx, l in enumerate(lines):
        if l.strip() != '':
            first_line = lines[idx]
            sp = re.findall(r'^\s+', first_line)
            if len(sp):
                spaces = sp[0]
            break            

    # Uncomment
    if first_line.strip().startswith(START):
        result = [line.replace(START, &quot;&quot;, 1).replace(END, &quot;&quot;, 1) if line.strip() else line for line in lines]
    else:
        result = [f'{spaces}{START}{line[len(spaces):]}{END}' if line.strip() else line for line in lines ]

    # Remove initial indent
    if result[0] and initial_indent:
        result[0] = result[0].replace(initial_indent, '', 1)

    if result:
        return '\n'.join(result)
    else:
        return ''
</code></pre>

<p><strong>å¤šè¡Œæ³¨é‡Šï¼š</strong></p>

<pre><code class="language-python">def comment_inline(snip, START=&quot;/* &quot;, END=&quot; */&quot;):
    text = snip.v.text
    lines = text.split('\n')[:-1]
    first_line = lines[0]
    initial_indent = snip._initial_indent
    spaces = ''

    # Get the first non-empty line
    for idx, l in enumerate(lines):
        if l.strip() != '':
            first_line = lines[idx]
            sp = re.findall(r'^\s+', first_line)
            if len(sp):
                spaces = sp[0]
            break            

    if text.strip().startswith(START):
        result = text.replace(START, '', 1).replace(END, '', 1)
    else:
        result = text.replace(spaces, spaces + START, 1).rstrip('\n') + END + '\n'

    if initial_indent:
        result = result.replace(initial_indent, '', 1)

    return result
</code></pre>

<p><strong>ä»£ç ç‰‡æ®µå®šä¹‰ï¼š</strong></p>

<pre><code class="language-vim">global !p
from javascript_snippets import (
	comment, comment_inline
)
endglobal

# ...

snippet c &quot;Toggle comment every single line&quot;
`!p
snip.rv = comment(snip, START='// ', END='')
`$0
endsnippet

snippet ci &quot;Toggle comment inline.&quot;
`!p
snip.rv = comment_inline(snip, START=&quot;/* &quot;, END=&quot; */&quot;)
`$0
endsnippet
</code></pre>

<p>åŠ¨å›¾æ¼”ç¤º</p>

<p><img src="//img30.360buyimg.com/devfe/jfs/t24175/330/2554434390/319822/5d8cf724/5b850d67N4c475946.gif" alt="python-snippets-to-comment" /></p>

<p>ä¸åŒçš„è¯­è¨€å¯ä»¥åœ¨å¯¹åº”çš„ç‰‡æ®µæ–‡ä»¶ä¸­å®šä¹‰å¹¶ä¼ å…¥æ³¨é‡Šç¬¦å·å‚æ•°å³å¯ï¼Œæœ‰äº†è¿™ä¸ªåŠŸèƒ½å°±å¯ä»¥æ„‰å¿«çš„åˆ é™¤å…¶å®ƒçš„ vim æ³¨é‡Šæ’ä»¶äº† ğŸ˜€</p>
</div>
                <footer>
                    <p class="meta" style="display:none">
                        <span class="byline author vcard">Posted</span>
                        
                        <span class="span">on</span>
                        <span class="categories">
                            
                            
                            <a class="category 0|1" href="https://keelii.com/categories/vim">vim</a>
                            
                        </span>
                        
                    </p>
                    
                    
                    <p class="meta salign">
                        
                        <span class="basic-alignment left">
                            &laquo; <a href="https://keelii.com/2018/08/12/fuzzy-finder-full-guide/" title="Previous Post: Fuzzy finder(fzf&#43;vim) ä½¿ç”¨å…¨æŒ‡å—">Fuzzy finder(fzf&#43;vim) ä½¿ç”¨å…¨æŒ‡å—</a>
                        </span>
                        

                        
                        <span class="basic-alignment right">
                            <a href="https://keelii.com/2018/09/03/HTTPie/" title="Nextious Post: HTTPie å®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç¿»è¯‘ç‰ˆ">HTTPie å®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç¿»è¯‘ç‰ˆ</a> &raquo;
                        </span>
                        
                    </p>
                </footer>
            </article>
            <section>
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script>
    (function() {
    var d = document, s = d.createElement('script');
    s.src = '//keelii-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


        </div>

        <aside class="sidebar">
    
        
<section id="side-toc" class="side-toc odd toggle">
    <h2><span>Table  of contents</span> <span class="close-toc" onclick="document.querySelector('#side-toc').classList.add('toggle')">Ã—</span></h2>
    <nav id="TableOfContents">
<ul>
<li><a href="#å®‰è£…">å®‰è£…</a></li>
<li><a href="#é…ç½®">é…ç½®</a></li>
<li><a href="#ä¾èµ–">ä¾èµ–</a></li>
<li><a href="#å®šä¹‰ä¸€ä¸ªä»£ç ç‰‡æ®µ">å®šä¹‰ä¸€ä¸ªä»£ç ç‰‡æ®µ</a>
<ul>
<li><a href="#å®šä¹‰æ ¼å¼">å®šä¹‰æ ¼å¼</a></li>
<li><a href="#æœ€å°åŒ–çš„ä¸€ä¸ªä»£ç ç‰‡æ®µ">æœ€å°åŒ–çš„ä¸€ä¸ªä»£ç ç‰‡æ®µ</a></li>
</ul></li>
<li><a href="#å¯è§†é€‰æ‹©åŒºçš„å†…å®¹ä¸ºå ä½ç¬¦">å¯è§†é€‰æ‹©åŒºçš„å†…å®¹ä¸ºå ä½ç¬¦</a></li>
<li><a href="#ä»£ç ç‰‡æ®µçš„å‚æ•°">ä»£ç ç‰‡æ®µçš„å‚æ•°</a></li>
<li><a href="#å†…å®¹è§£é‡Šå™¨">å†…å®¹è§£é‡Šå™¨</a></li>
<li><a href="#shell-ä»£ç ">shell ä»£ç </a>
<ul>
<li><a href="#vimscript-ä»£ç ">vimscript ä»£ç </a></li>
<li><a href="#python-ä»£ç ">python ä»£ç </a></li>
</ul></li>
<li><a href="#å ä½ç¬¦é€‰æ‹©">å ä½ç¬¦é€‰æ‹©</a></li>
<li><a href="#è‡ªå®šä¹‰ä¸Šä¸‹æ–‡">è‡ªå®šä¹‰ä¸Šä¸‹æ–‡</a></li>
<li><a href="#å¸¸è§ç”¨æ³•">å¸¸è§ç”¨æ³•</a>
<ul>
<li><a href="#è¡Œå†…è¿ç»­å±•å¼€">è¡Œå†…è¿ç»­å±•å¼€</a></li>
<li><a href="#ä½¿ç”¨æ­£åˆ™ä»£ç ç‰‡æ®µ">ä½¿ç”¨æ­£åˆ™ä»£ç ç‰‡æ®µ</a></li>
<li><a href="#ä½¿ç”¨-python-è§£é‡Šå™¨-visual-æ¨¡å¼å®ç°ä»£ç æ³¨é‡ŠåŠŸèƒ½">ä½¿ç”¨ python è§£é‡Šå™¨ + VISUAL æ¨¡å¼å®ç°ä»£ç æ³¨é‡ŠåŠŸèƒ½</a></li>
</ul></li>
</ul>
</nav>
    <div class="fold" onclick="document.querySelector('#side-toc').classList.toggle('toggle')">Â§</div>

</section>
<script>
document.onclick = function() {
    document.querySelector('#side-toc').classList.add('toggle')
}
document.querySelector('#side-toc').onclick = function(e) {
    e.stopPropagation()
}
</script>



    
</aside>

    </div>
</div>

<footer id="footer" role="contentinfo" class="container">
    <p>
        Copyright &copy; 2019 keelii
    </p>
</footer>

<script>

(function(window, document) {
    window.changeFont = function() {
        var el = document.getElementById('font-family')
        var font = localStorage.getItem('fontFamily')
        
        document.querySelectorAll('.typo').forEach(node => {
            node.classList.remove('sans-serif', 'serif')
            node.classList.add(font)
        })
        if (el) el.checked = font === 'sans-serif'
    }
    changeFont()
})(window, document); 
</script>





<script src="/javascripts/highlight.pack.js"></script>
<script>
if (typeof hljs !=="undefined") hljs.initHighlightingOnLoad()
</script>



<script>
!function(e){function t(e){for(var t=location.href,n=t.split("").reverse(),r=e.split(""),i=[],s=0,o=16;o>s;s++)i.push(r[s]+(n[s]||""));return i.join("")}var n=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.so\.com)/gi,r=e.location.href;if(r&&!n.test(r)&&window.navigator.appName){var i="//s.360.cn/so/zz.gif",o="0cbb5a2bef902d89e9dc9bb5f742b91c",u=t(o),a=new Image;r&&(i+="?url="+encodeURIComponent(r)),o&&(i+="&sid="+o),u&&(i+="&token="+u),o&&(a.src=i)}}(window);
</script>

</body>
</html>
